function echo(stringA,stringB){var Easymi={detailLog:false,defaultFailCallback:function(errCode,errMsg){if(Was.isEmulator){console.error("[Easymi.defaultFailCallback]code="+errCode+",msg="+errMsg)}else{console.debug("[Easymi.defaultFailCallback]code="+errCode+",msg="+errMsg)}}};Easymi.Utils={isEmpty:function(value,allowEmptyString){return(value===null)||(value===undefined)||(!allowEmptyString?value==="":false)||(Easymi.Utils.isArray(value)&&value.length===0)},isArray:("isArray" in Array)?Array.isArray:function(value){return toString.call(value)==="[object Array]"},isDate:function(value){return toString.call(value)==="[object Date]"},isObject:(toString.call(null)==="[object Object]")?function(value){return value!==null&&value!==undefined&&toString.call(value)==="[object Object]"&&value.ownerDocument===undefined}:function(value){return toString.call(value)==="[object Object]"},isPrimitive:function(value){var type=typeof value;return type==="string"||type==="number"||type==="boolean"},isFunction:(typeof document!=="undefined"&&typeof document.getElementsByTagName("body")==="function")?function(value){return toString.call(value)==="[object Function]"}:function(value){return typeof value==="function"},isNumber:function(value){return typeof value==="number"&&isFinite(value)},isNumeric:function(value){return !isNaN(parseFloat(value))&&isFinite(value)},isString:function(value){return typeof value==="string"},isBoolean:function(value){return typeof value==="boolean"},applyIf:function(object,config){var property;if(object){for(property in config){if(object[property]===undefined){object[property]=config[property]}}}return object},format:function(str){var args=arguments;return str.replace(/\{(\d+)\}/g,function(m,i){return args[i]})},replace:function(src,obj,isExecute){return src.replace(/@(\w*)/g,function(m){var key=m.replace("@","");var value=obj[key];if(typeof value=="string"){if(isExecute){if(Was.isEmulator){value=value.replace(/'/g,"''")}else{value=value.replace(/'/g,"''");value=value.replace(/\n/g,"\\n");value=value.replace(/\r/g,"\\r");value=value.replace(/;/g,"/;")}}if(value.charAt(0)=="'"){return value}else{return"'"+value+"'"}}else{if(value instanceof Date){return"'"+Easymi.Utils.formatDate(obj[key])+"'"}}if(value===0){return 0}return value||"''"})},toQueryObjects:function(name,value,recursive){var self=Easymi.Utils.toQueryObjects,objects=[],i,ln;if(Easymi.Utils.isArray(value)){for(i=0,ln=value.length;i<ln;i++){if(recursive){objects=objects.concat(self(name+"["+i+"]",value[i],true))}else{objects.push({name:name,value:value[i]})}}}else{if(Easymi.Utils.isObject(value)){for(i in value){if(value.hasOwnProperty(i)){if(recursive){objects=objects.concat(self(name+"["+i+"]",value[i],true))}else{objects.push({name:name,value:value[i]})}}}}else{objects.push({name:name,value:value})}}return objects},toQueryString:function(object){var paramObjects=[],params=[],i,j,ln,paramObject,value;for(i in object){if(object.hasOwnProperty(i)){paramObjects=paramObjects.concat(Easymi.Utils.toQueryObjects(i,object[i],true))}}for(j=0,ln=paramObjects.length;j<ln;j++){paramObject=paramObjects[j];value=paramObject.value;if(Easymi.Utils.isEmpty(value)){value=""}else{if(Easymi.Utils.isDate(value)){value=Easymi.Utils.formatDate(value)}}params.push(encodeURIComponent(paramObject.name)+"="+encodeURIComponent(String(value)))}return params.join("&")},getColumnFromSql:function(sql){var columns=sql.replace(/^select/i,"").replace(/from.*/i,"").split(",");var result=[],column,index,index2;for(var i=0;i<columns.length;i++){column=columns[i].replace(/(^\s*)|(\s*$)/g,"");index=column.toLowerCase().indexOf(" as ");if(index==-1){index2=column.lastIndexOf(" ");if(index2==-1){result.push(column.replace(/.*\./,""))}else{result.push(column.substr(index2+1))}}else{result.push(column.substr(index+3).replace(/(^\s*)|(\s*$)/g,""))}}return result},extend:function(baseClass,props){window.classInitializing=false;if(typeof(baseClass)==="object"){props=baseClass;baseClass=null}function F(){if(!window.classInitializing){if(baseClass){this.basePrototype=baseClass.prototype}this.init.apply(this,arguments)}}if(baseClass){window.classInitializing=true;F.prototype=new baseClass();F.prototype.constructor=F;window.classInitializing=false}for(var name in props){if(props.hasOwnProperty(name)){if(baseClass&&typeof(props[name])==="function"&&typeof(F.prototype[name])==="function"){F.prototype[name]=(function(name,fn){return function(){this.base=baseClass.prototype[name];return fn.apply(this,arguments)}})(name,props[name])}else{F.prototype[name]=props[name]}}}return F},parseDate:function(str){if(typeof str=="string"){var results=str.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) *$/);if(results&&results.length>3){return new Date(parseInt(results[1]),parseInt(results[2])-1,parseInt(results[3]))}results=str.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) +(\d{1,2}):(\d{1,2}):(\d{1,2}) *$/);if(results&&results.length>6){return new Date(parseInt(results[1]),parseInt(results[2])-1,parseInt(results[3]),parseInt(results[4]),parseInt(results[5]),parseInt(results[6]))
}results=str.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) +(\d{1,2}):(\d{1,2}):(\d{1,2})\.(\d{1,9}) *$/);if(results&&results.length>7){return new Date(parseInt(results[1]),parseInt(results[2])-1,parseInt(results[3]),parseInt(results[4]),parseInt(results[5]),parseInt(results[6]),parseInt(results[7]))}}return null},formatDate:function(v){if(v instanceof Date){var y=v.getFullYear();var m=v.getMonth()+1;var d=v.getDate();var h=v.getHours();var i=v.getMinutes();var s=v.getSeconds();var ms=v.getMilliseconds();if(ms>0){return y+"-"+m+"-"+d+" "+h+":"+i+":"+s+"."+ms}if(h>0||i>0||s>0){return y+"-"+m+"-"+d+" "+h+":"+i+":"+s}return y+"-"+m+"-"+d}return"argument is not date"}};__App=function(){};__App.prototype.exit=function(params){Was.exec("app","exitApp",params)};__App.prototype.callApp=function(command,args,successCB,failCB){args["__command"]=command;Was.exec("app","callApp",args,successCB,failCB||Easymi.defaultFailCallback)};__App.prototype.callNativeApp=function(options,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;if(!options){fcb(1,"必须传递参数");return}if(options.__otherParam){Easymi.Utils.applyIf(options,options.__otherParam)}Was.exec("app","callNativeApp",options,function(){console.debug("[app][callNativeApp][successCB]");if(successCB){successCB()}},fcb)};__App.prototype.callNativeApp_Email_Android=function(options,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;if(!options||!options.sendTo||!options.subject||!options.content){fcb(1,"必须传递相关参数");return}options.mimeType=options.mimeType||"text/html";if(options.mimeType.toLowerCase()=="text/html"){options.contentIsHtml=true}if(!Easymi.Utils.isArray(options.sendTo)){options.sendTo=[options.sendTo]}var emailAddresses=String.fromCharCode(3)+String.fromCharCode(4);for(var i=0;i<options.sendTo.length;i++){emailAddresses=emailAddresses+options.sendTo[i];if(i!=options.sendTo.length-1){emailAddresses=emailAddresses+String.fromCharCode(4)}}options.sendTo=emailAddresses;if(options.contentIsHtml){options.content=String.fromCharCode(3)+String.fromCharCode(8)+options.content}this.callNativeApp({__action:"android.intent.action.SEND",__category:"android.intent.category.DEFAULT",__type:options.mimeType,__otherParam:{"android.intent.extra.SUBJECT":options.subject,"android.intent.extra.TEXT":options.content,"android.intent.extra.EMAIL":options.sendTo}},successCB,fcb)};__App.prototype.callNativeApp_Calander_Android=function(options,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;options=options||{};if(options.date){options.date=Easymi.Utils.parseDate(options.date)}else{options.date=new Date()}options.date=options.date.getTime();this.callNativeApp({__url:"content://com.android.calendar/time/"+options.date,__action:"android.intent.action.VIEW",},successCB,fcb)};__App.prototype.addEventListener=function(eventName,eventCB){Was.addEventListener(eventName,eventCB)};__App.prototype.putContextValue=function(key,value){console.debug("[app][putContextValue]key="+key+",value="+value);Was.exec("context","put",{k:key,v:value},function(){console.debug("[app][putContextValue]sucessCB="+JSON.stringify(arguments))},Easymi.defaultFailCallback)};__App.prototype.getContextValue=function(key,successCB){console.debug("[app][getContextValue]key="+key);Was.exec("context","get",{k:key},function(args){console.debug("[app][getContextValue]sucessCB:"+JSON.stringify(args));successCB(args["v"])},Easymi.defaultFailCallback)};__App.prototype.setBadget=function(value){if(typeof value=="string"){value=parseInt(value)}if(typeof value!="number"){return}Was.exec("message","setAppBadge",{num:value},null,Easymi.defaultFailCallback)};__App.prototype.getBadget=function(successCB){Was.exec("message","getAppBadge",{},function(args){successCB(args["num"])},Easymi.defaultFailCallback)};__App.prototype.getSettings=function(successCB){Was.exec("app","settings",{},successCB,Easymi.defaultFailCallback)};__App.prototype.getSetting=function(key,successCB){Was.exec("app","setting",{key:key},function(setting){console.debug("[app][getSettings]success:"+JSON.stringify(arguments));successCB(setting["value"])},Easymi.defaultFailCallback)};__App.prototype.getNetState=function(){return Was.netState};__App.prototype.getDeviceInfo=function(){if(Was.deviceInfo){var p=Was.deviceInfo.pixel.split("x");return{os:Was.deviceInfo.os,type:Was.deviceInfo.type,largerPixel:parseInt(p[0]),smallerPixel:parseInt(p[1]),pixel:Was.deviceInfo.pixel}}return{os:"windows",type:"pad",largerPixel:screen.width,smallerPixel:screen.height,pixel:screen.width+"x"+screen.height}};__App.prototype.getUserInfo=function(successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;Was.exec("user","getUserInfo",{},function(data){console.log(JSON.stringify(data));if(successCB){successCB(data)}},fcb)};__App.prototype.getUserInfo=function(){return Was.userInfo};__App.prototype.getAppInfo=function(options,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;Was.exec("app","getAppInfo",options,function(data){if(successCB){successCB(data)}},fcb)};
__App.prototype.pauseApp=function(){Was.exec("app","pauseApp",{})};__App.prototype.fullScreenApp=function(parmas){Was.exec("app","fullScreenApp",parmas)};__App.prototype.restoreApp=function(parmas){Was.exec("app","restoreApp",parmas)};__App.prototype.goHome=function(parmas){console.log("goHome");Was.exec("app","goHome",parmas)};__App.prototype.setCookie=function(url,cookie,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;Was.exec("cookie","setCookie",{url:url,cookie:cookie},successCB,fcb)};__App.prototype.getCookie=function(url,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;Was.exec("cookie","getCookie",{url:url},function(cookie){if(successCB){successCB(cookie)}},fcb)};__App.prototype.getPushMsgList=function(args,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;if(!args){fcb(-1,"args can not be empty")}Was.exec("message","getPushMsgList",args,function(result){console.debug("[app][getPushMsgList]success:"+JSON.stringify(result));result.record=eval(result.record);if(successCB){successCB(result)}},fcb)};__App.prototype.delPushMsg=function(args,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;if(!args){fcb(-1,"args can not be empty")}if(!args.msgID){fcb(-1,"msgID can not be empty")}Was.exec("message","delPushMsg",{msgID:args.msgID},function(){if(successCB){successCB()}},fcb)};Easymi.app=new __App();__Device=function(){};__Device.prototype.setOrientation=function(orientation){console.debug("[Device][setOrientation]orientation="+orientation);if(orientation!=1&&orientation!=2){console.error("[Device][setOrientation]illegal param");return}Was.exec("device","setOrientation",{orientation:orientation},function(){console.debug("[Device][setOrientation][successCB]:"+JSON.stringify(arguments))},Easymi.defaultFailCallback)};__Device.prototype.getCurrentNetType=function(successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;Was.exec("device","getCurrentNetType",{},function(netType){if(successCB){successCB(netType)}},fcb)};Easymi.device=new __Device();function __File(fileName){this.fileName=fileName}__File.prototype.getOSPath=function(successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;console.debug("[file][getOSPath]fileName="+this.fileName);Was.exec("file","getFileOSPath",{EasyMIPath:this.fileName},function(args){console.debug("[file][getOSPath]successCB:"+JSON.stringify(args));if(successCB){successCB(args.OSPath)}},fcb)};__File.prototype.info=function(successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;Was.exec("file","info",{filepath:this.fileName},function(info){console.debug("[file][info][successCB]"+JSON.stringify(info));if(successCB){info.isDir=info.isDir==1;successCB(info)}},fcb)};__File.prototype.exist=function(successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;console.debug("[file][exist]fileName:"+this.fileName);Was.exec("file","exists",{filepath:this.fileName},function(args){console.debug("[file][exist][successCB]");var retCode=args["retCode"];if(retCode==0){successCB(true)}else{if(retCode==1){successCB(false)}else{if(retCode!=undefined){fcb()}else{if(successCB){successCB(true)}}}}},function(code,msg){console.debug("[file][exist][failCB]"+code+","+msg);if(code==1){if(successCB){successCB(false)}}else{fcb(code,msg)}})};__File.prototype.remove=function(successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;Was.exec("file","delete",{filepath:this.fileName,needConfirm:0},function(){if(successCB){successCB()}},fcb)};__File.prototype.view=function(options,callback){console.debug("[file][view]fileName="+this.fileName);options=options||{};if(!options.hasOwnProperty("useWebview")){options.useWebview=false}options.filepath=this.fileName;Was.exec("file","viewdoc",options,function(arg){console.debug("[file][view]callback,you clicked button "+arg.buttonIndex);if(callback){callback(arg.buttonIndex)}})};__File.prototype.readAsText=function(encoding,successCB,failCB){if(Easymi.Utils.isFunction(encoding)){successCB=encoding;failCB=successCB;encoding="utf-8"}var fcb=failCB||Easymi.defaultFailCallback;console.debug("[file][readAsText]fileName="+this.fileName+",encoding="+encoding);Was.exec("file","getFileContent",{filepath:this.fileName,encode:encoding},function(args){console.debug("[file][readAsText]sucessCB");if(successCB){successCB(args.content)}},fcb)};Easymi.File=__File;var __Media=function(){};__Media.prototype.getPicture=function(optionParams,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;console.debug("[image][getPicture]optionParams:"+JSON.stringify(optionParams));Was.exec("image","getPicture",optionParams,function(args){console.debug("[image][getPicture][successCB]"+JSON.stringify(args));if(optionParams.destinationType=="data"){successCB(args["imageData"])}else{if(optionParams.destinationType=="file"){successCB(args["imageFileOSPath"],args["imageURI"])}else{successCB(args["imageFileOSPath"],args["imageURI"],args["imageData"])}}},fcb)};__Media.prototype.getMultiPicture=function(optionParams,successCB,failCB){optionParams=optionParams||{};
if(!optionParams.targetWidth){optionParams.targetWidth=100}if(!optionParams.targetHeight){optionParams.targetHeight=100}if(!optionParams.encodingType){optionParams.encodingType="jpeg"}if(!optionParams.quality){optionParams.quality=50}if(!optionParams.limitTime){optionParams.limitTime=-1}optionParams.exifFlag=false;var fcb=failCB||Easymi.defaultFailCallback;console.debug("[media][getMultiPicture]optionParams:"+JSON.stringify(optionParams));Was.exec("image","getMultiCameraPics",optionParams,function(args){console.debug("[media][getMultiPicture][successCB]:"+JSON.stringify(args));successCB(args["imageURI"],args["imageFileOSPath"])},function(code,msg){console.debug("[media][getMultiPicture][failCB]:"+JSON.stringify(args));fcb(code,msg)})};__Media.prototype.save2album=function(options,successCB,failCB){console.debug("[media][save2album]options:"+JSON.stringify(options));var fcb=failCB||Easymi.defaultFailCallback;if(!options.filepath){fcb(1,"必须指定照片路径");return}Was.exec("image","save2album",options,function(args){console.debug("[media][save2album][successCB]:"+JSON.stringify(args));if(successCB){successCB()}},fcb)};__Media.prototype.captureAudioStart=function(options,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;Was.exec("media","captureAudioStart",options,function(){console.debug("[media][captureAudioStart]successCB:"+JSON.stringify(arg));if(successCB){successCB()}},fcb)};__Media.prototype.captureAudioPause=function(successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;Was.exec("media","captureAudioPause",options,function(){console.debug("[media][captureAudioPause]successCB:"+JSON.stringify(arg));if(successCB){successCB()}},fcb)};__Media.prototype.captureAudioResume=function(successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;Was.exec("media","captureAudioResume",options,function(){console.debug("[media][captureAudioResume]successCB:"+JSON.stringify(arg));if(successCB){successCB()}},fcb)};__Media.prototype.captureAudioStop=function(successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;Was.exec("media","captureAudioStop",{},function(file){console.debug("[media][captureAudioStop]successCB:"+JSON.stringify(file));if(successCB){successCB(file)}},fcb)};__Media.prototype.getSupportedVideoQuality=function(successCB){Was.exec("media","getSupportVideo",{},function(arg){if(successCB){successCB(arg.supportList)}},Easymi.defaultFailCallback)};__Media.prototype.captureVideo=function(options,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;options=options||{};Was.exec("media","captureVideo",options,function(result){console.debug("[media][captureVideo]successCB:"+JSON.stringify(result));if(successCB){successCB(result)}},fcb)};Easymi.media=new __Media();var __Proxy=function(){};__Proxy.prototype.requestSetup=function(defaultOpts){this.defaultOpts=defaultOpts||{};return this};__Proxy.prototype.extend=function(dest,source){var args,i,k,ride,v;args=[].slice.call(arguments);ride=typeof args[args.length-1]==="boolean"?args.pop():true;i=1;if(args.length===1){dest={};i=0}while(source=args[i++]){for(k in source){v=source[k];if(ride||!(k in dest)){dest[k]=v}}}return dest};__Proxy.prototype.request=function(options,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback,scb="";scb=successCB;options=options||{};options.params=JSON.stringify(options.params);Was.exec("proxy","request",options,function(result){console.debug("[proxy][request]successCB:"+JSON.stringify(result));scb&&scb(JSON.parse(result.content))},function(eorrCode,eorrMsg){console.log(eorrCode+eorrMsg);failCB&&failCB(eorrCode,eorrMsg)});return this};var __FileTrans=Easymi.Utils.extend({init:function(url,path,successCB,failCB,plugIn,methods){this.url=url;this.path=path;this.successCB=successCB;this.failCB=failCB||Easymi.defaultFailCallback;this.plugIn=plugIn;this.methods=methods;console.debug("[FileTrans][construtor]:"+JSON.stringify(this))},start:function(isInstant){console.debug("[FileTrans][start]begin...");var that=this;isInstant=isInstant||false;Was.exec(that.plugIn,that.methods[0],{url:that.url,path:that.path,taskflag:isInstant},function(args){console.debug("[FileTrans][successCB]:"+JSON.stringify(args));that.successCB(args["progress"],args["groupName"],args["remoteFileName"])},this.failCB)},pause:function(){console.debug("[FileTrans][start]pause...");Was.exec(this.plugIn,this.methods[1],{url:this.url})},resume:function(){this.pause()},stop:function(){console.debug("[FileTrans][start]stop...");Was.exec(this.plugIn,this.methods[2],{url:this.url})}});__Proxy.prototype.Download=Easymi.Utils.extend(__FileTrans,{init:function(url,path,successCB,failCB){this.base(url,path,successCB,failCB,"download",["download","pausedown","stopdown"])}});__Proxy.prototype.Upload=Easymi.Utils.extend(__FileTrans,{init:function(url,path,successCB,failCB){this.base(url,path,successCB,failCB,"upload",["upload","pauseupload","stopupload"])}});Easymi.proxy=new __Proxy();function __SqliteDB(dbName){this.dbName=dbName?dbName:"";this.connID=-1}__SqliteDB.prototype.open=function(successCB,failCB){var _this=this;
var fcb=failCB||Easymi.defaultFailCallback;console.debug("[sqlite][open]enter,dbName="+this.dbName);Was.exec("sdb","open",{dbname:this.dbName},function(args){console.debug("[sqlite][open][sucessCB]:args="+JSON.stringify(args));_this.connID=args.connID;if(successCB){successCB()}},fcb)};__SqliteDB.prototype.close=function(){console.debug("[sqlite][close]enter,connID="+this.connID);var that=this;Was.exec("sdb","close",{connID:this.connID},function(args){that.connID=-1;console.debug("[sqlite][close][sucessCB]:args="+JSON.stringify(args))},function(code,msg){that.connID=-1;console.debug("[sqlite][close][failCB]:args="+JSON.stringify(args));Easymi.defaultFailCallback(code,msg)})};__SqliteDB.prototype.execute=function(sql,params,returnRowId,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;if(this.connID==-1){fcb(-1,"connection is not ready!");return}var finalSql,sqlArray;if(Easymi.Utils.isArray(sql)){returnRowId=false;sqlArray=[];for(var i=0;i<sql.length;i++){sqlArray.push(Easymi.Utils.replace(sql[i],params?params[i]:undefined,true))}if(Was.isEmulator){finalSql=sqlArray}else{finalSql=sqlArray.join(";")}}else{finalSql=Easymi.Utils.replace(sql,params,true)}if(Easymi.detailLog){console.debug("[sqlite][execute]connID="+this.connID+",sql:"+finalSql)}else{console.debug("[sqlite][execute]connID="+this.connID)}Was.exec("sdb","execute",{connID:this.connID,sql:finalSql,getNewRowID:returnRowId},function(args){console.debug("[sqlite][execute][sucessCB]:args="+JSON.stringify(args));if(successCB){successCB(args["rowID"])}},fcb)};__SqliteDB.prototype.query=function(sql,params,queryConfig,successCB,failCB){console.debug("[sqlite][query]enter");var errorMsg;var fcb=failCB||Easymi.defaultFailCallback;if(this.connID==-1){fcb(-1,"connection is not ready!");return}if(!queryConfig||!(queryConfig.colsDef)){errorMsg="[sqlite][query] queryConfig.colsDef must define";fcb(errorMsg);return}queryConfig.columnTypes=queryConfig.colsDef.split(",");if(!(queryConfig.recordType)){queryConfig.recordType="object"}if(!(queryConfig.countPerNext)){queryConfig.countPerNext=10}if(queryConfig.recordType=="object"){queryConfig.objectNames=Easymi.Utils.getColumnFromSql(sql)}var _this=this;sql=Easymi.Utils.replace(sql,params);if(queryConfig.recordType=="object"&&queryConfig.objectNames.length!=queryConfig.columnTypes.length){errorMsg="[sqlite][query]select中的列数量与queryConfig.colsDef数量不同，执行中断！！！"+sql;fcb(-1,errorMsg);return}console.debug("[sqlite][query]connID="+this.connID+",sql:"+sql+",queryConfig:"+JSON.stringify(queryConfig));var records=[];Was.exec("sdb","query",{connID:this.connID,sql:sql},function(args){console.debug("[sqlite][query][sucessCB]:connId="+_this.connID+JSON.stringify(args));_this._next(_this,args.cursorID,queryConfig,records,successCB,fcb)},fcb)};__SqliteDB.prototype._next=function(_this,cursorId,queryConfig,records,callback,failCB){if(Easymi.detailLog){console.debug("[sqlite][_next],connID="+_this.connID+",cursorId="+cursorId)}Was.exec("sdb","next",{cursorID:cursorId,colsTypeDef:queryConfig.colsDef,readCount:queryConfig.countPerNext},function(args){if(Easymi.detailLog){console.debug("[sqlite][_next][sucessCB]connID="+_this.connID+",cusorID="+cursorId+",args="+JSON.stringify(args))}var retCode=args.retCode;if(retCode==-1){console.debug("[sqlite][_next],retCode=-1,release cursor and return result");Was.exec("sdb","releaseCursor",{cursorID:cursorId},null);callback(records);return}if(Was.isEmulator){var temp=args.record}else{eval("var temp ="+args.record+";")}if(!(Easymi.Utils.isArray(temp))){temp=[temp]}if(Easymi.detailLog){console.debug("[sqlite][_next]temp="+JSON.stringify(temp))}for(var ri=0;ri<temp.length;ri++){var tempi=temp[ri];if(queryConfig.recordType=="array"){if(Easymi.detailLog){console.debug("to array begin")}var r=[],v;for(var i=0;i<100;i++){v=tempi[i];if(v!=undefined){if(queryConfig.columnTypes[i]=="D"){r.push(Easymi.Utils.parseDate(v))}else{r.push(v)}}else{break}}if(Easymi.detailLog){console.debug("to array end."+JSON.stringify(r))}records.push(r)}else{if(Easymi.detailLog){console.debug("to object begin")}var r={},v;for(var i=0;i<100;i++){v=tempi[i];if(v!=undefined){if(queryConfig.columnTypes[i]=="D"){r[queryConfig.objectNames[i]]=Easymi.Utils.parseDate(v)}else{r[queryConfig.objectNames[i]]=v}}else{break}}if(Easymi.detailLog){console.debug("to object end."+JSON.stringify(r))}records.push(r)}}if(args.EOF==1){Was.exec("sdb","releaseCursor",{cursorID:cursorId},null);callback(records)}else{_this._next(_this,cursorId,queryConfig,records,callback,failCB)}},function(code,msg){if(code==-1){console.debug("[sqlite][_next],retCode=-1,release cursor and return result");Was.exec("sdb","releaseCursor",{cursorID:cursorId},null);callback(records)}else{failCB(code,msg)}})};__SqliteDB.prototype.executeQ=function(sql,params,returnRowId,successCB,failCB){var _this=this;this.open(function(){_this.execute(sql,params,returnRowId,function(rowid){_this.close();if(successCB){successCB(rowid)}},failCB)},failCB)};__SqliteDB.prototype.queryQ=function(sql,params,queryConfig,successCB,failCB){var _this=this;
this.open(function(){_this.query(sql,params,queryConfig,function(records){_this.close();successCB(records)},failCB)},failCB)};__SqliteDB.prototype.exists=function(successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;if(!successCB){fcb(-1,"必须有successCB回调函数");return}Was.exec("sdb","exists",{dbname:this.dbName},function(){successCB(true)},function(code,msg){if(code==1){successCB(false)}else{fcb(code,msg)}})};__SqliteDB.prototype.restore=function(sourceDBPath,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;Was.exec("sdb","restore",{dbname:this.dbName,sourceDBPath:sourceDBPath},function(){if(successCB){successCB()}},fcb)};Easymi.sqlite={Connection:__SqliteDB};Easymi.crypto={encrypt:function(src,key,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;console.debug("[crypto][encrypt]:key="+key+",src="+src);Was.exec("crypto","AESEncode",{key:key,text:src},function(args){console.debug("[crypto][encrypt]sucessCB:"+JSON.stringify(args));if(successCB){successCB(args["text"])}},fcb)},decrypt:function(src,key,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;console.debug("[crypto][decrypt]:key="+key+",src="+src);Was.exec("crypto","AESDecode",{key:key,text:src},function(args){console.debug("[crypto][decrypt]sucessCB:"+JSON.stringify(args));if(successCB){successCB(args["text"])}},fcb)},obscureFile:function(options,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;if(!options||!options.obscure||!options.sourceFile||!options.outputFile){fcb(-1,"必须设置options的obscure,sourceFile,outputFile属性");return}console.debug("[crypto][obscureFile]:options:"+JSON.stringify(options));Was.exec("crypto","obscureFile",options,function(args){console.debug("[crypto][obscureFile]successCB:"+JSON.stringify(args));if(successCB){successCB()}},fcb)},restoreFile:function(options,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;if(!options||!options.obscure||!options.sourceFile||!options.outputFile){fcb(-1,"必须设置options的obscure,sourceFile,outputFile属性");return}console.debug("[crypto][restoreFile]:options:"+JSON.stringify(options));Was.exec("crypto","restoreFile",options,function(args){console.debug("[crypto][restoreFile]successCB:"+JSON.stringify(args));if(successCB){successCB()}},fcb)}};Easymi.scaner={scanBarCode:function(successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;Was.exec("barcode","getBarcode",{},function(args){console.debug("[barcode][getBarcode]successCB:"+JSON.stringify(args));if(successCB){successCB(args.code)}},fcb)},scanTDCode:function(successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;Was.exec("barcode","getTdBarcode",{},function(args){console.debug("[barcode][getTdBarcode]successCB:"+JSON.stringify(args));if(successCB){successCB(args.code)}},fcb)}};Easymi.location={getCurrentPosition:function(successCB,failCB){console.debug("[location][locate]begin...");var fcb=failCB||Easymi.defaultFailCallback;Was.exec("location","locate",{type:"Cell"},function(args){console.debug("[location][locate]success:"+JSON.stringify(args));if(successCB){successCB(args)}},fcb)},getCurrentPositionByGPS:function(successCB,failCB){console.debug("[location][locateByGPS]begin...");var fcb=failCB||Easymi.defaultFailCallback;Was.exec("location","locate",{type:"GPS"},function(args){console.debug("[location][locateByGPS]success:"+JSON.stringify(args));if(successCB){successCB(args)}},fcb)}};Easymi.zip={unzip:function(zipFile,outPath,successCB,failCB){console.debug("[zip][unzip]param:"+zipFile+","+outPath);var fcb=failCB||Easymi.defaultFailCallback;Was.exec("zip","unzip",{zipFilePath:zipFile,outPath:outPath},function(){console.debug("[zip][unzip]success:"+JSON.stringify(arguments));if(successCB){successCB()}},fcb)}};Easymi.phone={call:function(number,confirm){console.debug("[phone][call]number:"+number);console.debug("[phone][call]confirm:"+confirm);Was.exec("phone","call",{number:number,confirm:confirm})},sms:function(number,content){var p={number:number,content:content?content:""};console.debug("[phone][sms]param:"+JSON.stringify(p));Was.exec("sms","send",p)}};Easymi.contact={add:function(contact,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;if(!contact){fcb(-1,"must set contact")}console.debug("[contact][add]param:"+JSON.stringify(contact));Was.exec("contact","add",contact,function(){console.debug("[contact][add]success:"+JSON.stringify(arguments));if(successCB){successCB()}},fcb)},remove:function(contactId,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;if(!contactId){fcb(-1,"must set contactId")}console.debug("[contact][remove]param:"+contactId);Was.exec("contact","delete",{id:contactId},function(){console.debug("[contact][remove]success:"+JSON.stringify(arguments));if(successCB){successCB()}},fcb)},update:function(contact,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;if(!contact){fcb(-1,"must set contact")}console.debug("[contact][update]param:"+JSON.stringify(contact));Was.exec("contact","update",contact,function(){console.debug("[contact][update]success:"+JSON.stringify(arguments));
if(successCB){successCB()}},fcb)},find:function(options,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;if(!options){fcb(-1,"must set options")}console.debug("[contact][find]param:"+JSON.stringify(options));Was.exec("contact","find",options,function(response){console.debug("[contact][find]success:"+JSON.stringify(arguments));var count=response.count;var contacts=[];for(var i=0;i<count;i++){var index="record"+i;var record_temp=response[index];eval("var record = "+record_temp);var contact={id:record.id,name:record.name,phones:record.phones[0]};contacts.push(contact)}var contacts_str=JSON.stringify(contacts);if(successCB){successCB(contacts_str)}},fcb)}};Easymi.weixin={send:function(content,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;if(!content){fcb(-1,"must set content")}if(content&&content.contentType=="1"){if(!content.text){fcb(-1,"contentType == 1, must set content.text")}}if(content&&content.contentType=="2"){if(!(content.imagePath||content.imgUrl)){fcb(-1,"contentType == 2, must set content.imagePath or content.imgUrl")}}if(content&&content.contentType=="3"){if(!(content.videoUrl||content.videoLowBandUrl)){fcb(-1,"contentType == 3, must set content.videoUrl or content.videoLowBandUrl")}}if(content&&content.contentType=="4"){if(!(content.musicUrl||content.musicLowBandUrl)){fcb(-1,"contentType == 4, must set content.musicUrl or content.musicLowBandUrl")}}if(content&&content.contentType=="5"){if(!content.webPageUrl){fcb(-1,"contentType == 5, must set content.webPageUrl")}}console.debug("[weixin][send]param:"+JSON.stringify(content));Was.exec("wenxin","send",content,function(){console.debug("[weixin][send]success:"+JSON.stringify(arguments));if(successCB){successCB()}},fcb)}};Easymi.kuaishua={requestPay:function(content,successCB,failCB){var fcb=failCB||Easymi.defaultFailCallback;if(!content){fcb(-1,"content can not be empty")}if(!content.orderId){fcb(-1,"orderId can not be empty")}if(!content.productName){fcb(-1,"productName can not be empty")}if(!content.amount){fcb(-1,"amount can not be empty")}else{content.amount=parseFloat(content.amount)*100}console.debug("[kuaishua][requestPay]param:"+JSON.stringify(content));Was.exec("kuaishua","requestPay",content,function(args){console.debug("[kuaishua][requestPay]success:"+JSON.stringify(args));if(successCB){var result={orderId:args["orderId"],amount:parseFloat(args["amount"])/100,requestId:args["requestId"],txnReferenceId:(Easymi.getDeviceInfo.os!="iOS")?args["txnReferenceId"]:null};successCB(result)}},fcb)}};Easymi.contactor=(function(){var extend=function(dest,src){if(arguments.length<2){src=dest;dest={}}dest=dest||{};if(src){for(key in src){if(src.hasOwnProperty(key)){dest[key]=src[key]}}}return dest};var chooseContactors=function(opts,successCB,failCB){var defaultOpts={initList:[],isSticky:false,isSimple:true};opts=opts||{};opts=extend(defaultOpts,opts);console.log("联系人选择接口接收的参数:"+JSON.stringify(opts));if(Easymi.Utils.isArray(opts.initList)){opts.initList=opts.initList.join(",")}opts.initList+="";failCB=failCB||Easymi.defaultFailCallback;Was.exec("contactor","chooseContactors",opts,function(res){if(res&&res.selects){res.selects=Function("return "+res.selects)()}console.log("联系人选择接口成功回调接收的参数:"+JSON.stringify(res));successCB&&successCB.call(null,res)},failCB)};return{"chooseContactors":chooseContactors}})();var __Pay=function(){};__Pay.prototype.payRequest=function(options,successCB,failCB){options=options||{};Was.exec("pay","payRequest",options,function(result){console.debug("[pay][payRequest]successCB:"+JSON.stringify(result));if(successCB){successCB(result)}},function(eorrCode,eorrMsg){console.log("[pay][payRequest]failCB:"+JSON.stringify(arguments));failCB&&failCB(eorrCode,eorrMsg)})};Easymi.pay=new __Pay();var __Car=function(){};__Car.prototype.setDefaultCar=function(options){console.log("setDefaultCar");Was.exec("car","setDefaultCar",options)};__Car.prototype.setCurrentCar=function(options){console.log("setCurrentCar");Was.exec("car","setCurrentCar",options)};Easymi.car=new __Car();var __PopView=function(){};__PopView.prototype.show=function(options){console.log("popView.show");Was.exec("popView","show",options)};__PopView.prototype.dismiss=function(){console.log("popView.dismiss");Was.exec("popView","show",{})};Easymi.popView=new __PopView();var hello="你好";alert("hello world")};